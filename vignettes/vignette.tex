% \VignetteIndexEntry{rYouteria Guide}
%\VignettePackage{rYoutheria}
\documentclass[a4paper]{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{a4wide}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{array}

% bibliography style
\usepackage[sectionbib,round]{natbib}
\bibliographystyle{mybst}
\setcounter{secnumdepth}{3}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\title{Extracting data from the Youtheria database into R}
\author{Tom August, CEH}
\date\today
\maketitle
\section{Introduction}
Youtheria is an online dataset containing data on the life history, ecology, taxonomy and geography of mammals. This package provides methods to retrieve data from this resource

\section{Installation}
The package can be installed directly from GitHub like this

\begin{verbatim}
# Install devtools
install.packages("devtools")

# Load devtools
library(devtools)

# Install rYoutheria from github
install_github("rYoutheria", username = "BiologicalRecordsCentre")

# Load rYoutheria
library(rYoutheria)
\end{verbatim}

\section{Choosing search terms}
When searching Youtheria it is likely that you have a measurement type in mind, such as body mass or diet. To look up what measurement types are available use the getMeasurementTypes() function:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Load rYoutheria}
\hlkwd{library}\hlstd{(rYoutheria)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# Loading required package: plyr\\\#\# Loading required package: jsonlite\\\#\# Loading required package: reshape2\\\#\# Loading required package: RCurl\\\#\# Loading required package: bitops}}\begin{alltt}
\hlcom{# Get a list of all measurement types}
\hlstd{MTs} \hlkwb{<-} \hlkwd{getMeasurementTypes}\hlstd{()}
\hlkwd{head}\hlstd{(MTs)}
\end{alltt}
\begin{verbatim}
##   Id               Name
## 1 18     Activity Cycle
## 2  9 Age at Eye Opening
## 3 13 Age at First Birth
## 4 14   Average Lifespan
## 5  1          Body Mass
## 6 21               Diet
\end{verbatim}
\begin{alltt}
\hlcom{# Look up a specific measurement type}
\hlkwd{getMeasurementTypes}\hlstd{(}\hlkwc{measurementType}\hlstd{=}\hlstr{'Body Mass'}\hlstd{)}
\end{alltt}
\begin{verbatim}
##   Id      Name
## 1  1 Body Mass
\end{verbatim}
\end{kframe}
\end{knitrout}

Species names in Youtheria are linked to definitions given in the Mammal Species of the World books, and when it comes to searching you can search under either the 1993 definitions or the 2005 definitions.

rYoutheria also allows searching by country or study site ID. You can get a list of countries by using the getCountries() function. This takes no arguments and simply gives you a list of all countries available

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Get a list of countries}
\hlstd{Cs} \hlkwb{<-} \hlkwd{getCountries}\hlstd{()}
\hlkwd{head}\hlstd{(Cs)}
\end{alltt}
\begin{verbatim}
##      countryName countryId
## 1     Afganistan         2
## 2  Ã…land Islands         5
## 3        Albania         6
## 4        Algeria        65
## 5 American Samoa        12
## 6        Andorra         7
\end{verbatim}
\end{kframe}
\end{knitrout}

\section{Choosing search terms}
Once we have decided what our search terms are going to be we can use the getMeasurementData() function.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Get measurement data for dispersal age}
\hlstd{dispAge} \hlkwb{<-} \hlkwd{getMeasurementData}\hlstd{(}\hlkwc{measurementType} \hlstd{=} \hlstr{'Dispersal Age'}\hlstd{,}
                              \hlkwc{silent} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlcom{# Preview some of the results}
\hlkwd{head}\hlstd{(dispAge[,}\hlkwd{c}\hlstd{(}\hlstr{'Genus'}\hlstd{,}\hlstr{'Species'}\hlstd{,}\hlstr{'Data Value'}\hlstd{,}\hlstr{'Measure'}\hlstd{)])}
\end{alltt}
\begin{verbatim}
##         Genus       Species Data Value     Measure
## 1    Petaurus     breviceps        8.5    Midrange
## 2      Castor    canadensis          2 Unspecified
## 3     Marmota  flaviventris          1 Unspecified
## 4    Dasyurus albopunctatus          4 Unspecified
## 5    Dasyurus     spartacus          4 Unspecified
## 6 Sminthopsis     virginiae         65 Unspecified
\end{verbatim}
\begin{alltt}
\hlcom{# Get measurement data for body mass of Daubenton's bats}
\hlstd{bodyMassDaub} \hlkwb{<-} \hlkwd{getMeasurementData}\hlstd{(}\hlkwc{measurementType} \hlstd{=} \hlstr{'Body Mass'}\hlstd{,}
                                   \hlkwc{MSW05Binomial} \hlstd{=} \hlstr{'Myotis daubentonii'}\hlstd{,}
                                   \hlkwc{silent} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlkwd{head}\hlstd{(bodyMassDaub[,}\hlkwd{c}\hlstd{(}\hlstr{'Genus'}\hlstd{,}\hlstr{'Species'}\hlstd{,}\hlstr{'Data Value'}\hlstd{,}\hlstr{'Units Weight'}\hlstd{)])}
\end{alltt}
\begin{verbatim}
##    Genus     Species Data Value Units Weight
## 1 Myotis  daubentoni        7.4        grams
## 2 Myotis  daubentoni        7.4        grams
## 3 Myotis  daubentoni       2.09        grams
## 4 Myotis daubentonii          7        grams
## 5 Myotis daubentonii        8.5        grams
## 6 Myotis daubentonii       8.94        grams
\end{verbatim}
\begin{alltt}
\hlcom{# Get measurement data for age of maturity of Swiss Lynx}
\hlstd{LynxSwiss} \hlkwb{<-} \hlkwd{getMeasurementData}\hlstd{(}\hlkwc{measurementType} \hlstd{=} \hlstr{'Sexual Maturity Age'}\hlstd{,}
                                \hlkwc{MSW05Binomial} \hlstd{=} \hlstr{'Lynx lynx'}\hlstd{,}
                                \hlkwc{country} \hlstd{=} \hlstr{'Switzerland'}\hlstd{,}
                                \hlkwc{silent} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlkwd{head}\hlstd{(LynxSwiss[,}\hlkwd{c}\hlstd{(}\hlstr{'Genus'}\hlstd{,}\hlstr{'Species'}\hlstd{,}\hlstr{'Data Value'}\hlstd{,}\hlstr{'Measure'}\hlstd{)])}
\end{alltt}
\begin{verbatim}
##   Genus Species Data Value Measure
## 1  Lynx    lynx       1.75    Mean
## 2  Lynx    lynx       2.75    Mean
\end{verbatim}
\end{kframe}
\end{knitrout}

For more help, and to see all of the functions in the package use the following command:

\begin{verbatim}
help(package = rYoutheria)
\end{verbatim}


\end{document}
